---
host_name: "bkk01.rotko.net"
host_timezone: "Asia/Bangkok"
ansible_host: "192.168.33.117"
role: "proxmox"

kernel_modules:
  - k10temp
  - zfs

default_need_port_forwarding: True
default_gw_device: "enp36s0"
default_storage: "zfs_storage"

lxc_nodes:
  - host: "dot01"
    proxmox_config:
      vmid: "101"
      hostname: "{{ hostvars['dot01']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['dot01']['netif'] }}"
      cores: 2
      memory: 20480
      swap: 10240
      password: N0tS4l4k4l4!
      disk: "{{ default_storage }}:20"
      mounts: '{"mp0":"{{ default_storage }}:350,mp={{ hostvars["dot01"]["polkadot_base"] }}"}'
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "polkadot validator node: {{ hostvars['dot01']['host_name'] }}"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "{{ hostvars['dot01']['ansible_port'] }}"
        to_host: "{{ hostvars['dot01']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "{{ hostvars['dot01']['polkadot_port'] }}"
        to_host: "{{ hostvars['dot01']['container_ip'] }}:{{ hostvars['dot01']['polkadot_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['dot01']['polkadot_prom_port'] }}"
        to_host: "{{ hostvars['dot01']['container_ip'] }}:{{ hostvars['dot01']['polkadot_prom_port'] }}"
        protocol: "tcp"
  - host: "ksm01"
    proxmox_config:
      vmid: "201"
      hostname: "{{ hostvars['ksm01']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['ksm01']['netif'] }}"
      cores: 2
      memory: 20480
      swap: 10240
      password: N0tS4l4k4l4!
      disk: "local:20"
      mounts: '{"mp0":"{{ default_storage }}:450,mp={{ hostvars["ksm01"]["polkadot_base"] }}"}'
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "kusama validator node: {{ hostvars['ksm01']['host_name'] }}"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "{{ hostvars['ksm01']['ansible_port'] }}"
        to_host: "{{ hostvars['ksm01']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "{{ hostvars['ksm01']['polkadot_p2p_port'] }}"
        to_host: "{{ hostvars['ksm01']['container_ip'] }}:{{ hostvars['ksm01']['polkadot_p2p_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['ksm01']['polkadot_prom_port'] }}"
        to_host: "{{ hostvars['ksm01']['container_ip'] }}:{{ hostvars['ksm01']['polkadot_prom_port'] }}"
        protocol: "tcp"
  - host: "ksm02"
    proxmox_config:
      vmid: "202"
      hostname: "{{ hostvars['ksm02']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['ksm02']['netif'] }}"
      cores: 2
      memory: 20480
      swap: 10240
      password: N0tS4l4k4l4!
      disk: "local:20"
      mounts: '{"mp0":"{{ default_storage }}:450,mp={{ hostvars["ksm02"]["polkadot_base"] }}"}'
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "Kusama 2nd validator node: {{ hostvars['ksm02']['host_name'] }}"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "{{ hostvars['ksm02']['ansible_port'] }}"
        to_host: "{{ hostvars['ksm02']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "{{ hostvars['ksm02']['polkadot_p2p_port'] }}"
        to_host: "{{ hostvars['ksm02']['container_ip'] }}:{{ hostvars['ksm02']['polkadot_p2p_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['ksm02']['polkadot_prom_port'] }}"
        to_host: "{{ hostvars['ksm02']['container_ip'] }}:{{ hostvars['ksm02']['polkadot_prom_port'] }}"
        protocol: "tcp"
...
