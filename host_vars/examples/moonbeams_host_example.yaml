---
host_name: "eur01.rotko.net"
host_timezone: "Europe/Berlin"
ansible_host: "148.251.140.12"
role: "proxmox"

kernel_modules:
  - k10temp
  - zfs

default_need_portforwarding: True
default_gw_device: "enp7s0"
default_storage: "zfs_storage"

lxc_nodes:
  - host: "beam01"
    proxmox_config:
      vmid: "777"
      hostname: "{{ hostvars['beam01']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['beam01']['netif'] }}"
      cores: 4
      memory: 16384
      swap: 8192
      password: vaultHERE!
      disk: "{{ default_storage }}:20"
      mounts: '{"mp0":"{{ default_storage }}:2000,mp={{ hostvars["beam01"]["moonbeam_base"] }}"}'
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "moonbeam node: {{ hostvars['beam01']['host_name'] }} with moonbeam blockchain"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "50003"
        to_host: "{{ hostvars['beam01']['container_ip'] }}:10050"
        protocol: "tcp"
      - from_port: "{{ hostvars['beam01']['ansible_port'] }}"
        to_host: "{{ hostvars['beam01']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "{{ hostvars['beam01']['moonbeam_base_port'] }}"
        to_host: "{{ hostvars['beam01']['container_ip'] }}:{{ hostvars['beam01']['moonbeam_base_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['beam01']['moonbeam_base_rpc_port'] }}"
        to_host: "{{ hostvars['beam01']['container_ip'] }}:{{ hostvars['beam01']['moonbeam_base_rpc_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['beam01']['moonbeam_base_ws_port'] }}"
        to_host: "{{ hostvars['beam01']['container_ip'] }}:{{ hostvars['beam01']['moonbeam_base_ws_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['beam01']['moonbeam_chain_port'] }}"
        to_host: "{{ hostvars['beam01']['container_ip'] }}:{{ hostvars['beam01']['moonbeam_chain_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['beam01']['moonbeam_chain_rpc_port'] }}"
        to_host: "{{ hostvars['beam01']['container_ip'] }}:{{ hostvars['beam01']['moonbeam_chain_rpc_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['beam01']['moonbeam_chain_ws_port'] }}"
        to_host: "{{ hostvars['beam01']['container_ip'] }}:{{ hostvars['beam01']['moonbeam_chain_ws_port'] }}"
        protocol: "tcp"
  - host: "rvr01"
    proxmox_config:
      vmid: "201"
      hostname: "{{ hostvars['rvr01']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['rvr01']['netif'] }}"
      cores: 4
      memory: 16384
      swap: 8192
      password: vaultHERE!
      disk: "{{ default_storage }}:20"
      mounts: '{"mp0":"{{ default_storage }}:3000,mp={{ hostvars["rvr01"]["moonbeam_base"] }}"}'
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "moonbeam node: {{ hostvars['rvr01']['host_name'] }}"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "50004"
        to_host: "{{ hostvars['rvr01']['container_ip'] }}:10050"
        protocol: "tcp"
      - from_port: "{{ hostvars['rvr01']['ansible_port'] }}"
        to_host: "{{ hostvars['rvr01']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "{{ hostvars['rvr01']['moonbeam_base_port'] }}"
        to_host: "{{ hostvars['rvr01']['container_ip'] }}:{{ hostvars['rvr01']['moonbeam_base_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['rvr01']['moonbeam_base_rpc_port'] }}"
        to_host: "{{ hostvars['rvr01']['container_ip'] }}:{{ hostvars['rvr01']['moonbeam_base_rpc_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['rvr01']['moonbeam_base_ws_port'] }}"
        to_host: "{{ hostvars['rvr01']['container_ip'] }}:{{ hostvars['rvr01']['moonbeam_base_ws_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['rvr01']['moonbeam_chain_port'] }}"
        to_host: "{{ hostvars['rvr01']['container_ip'] }}:{{ hostvars['rvr01']['moonbeam_chain_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['rvr01']['moonbeam_chain_rpc_port'] }}"
        to_host: "{{ hostvars['rvr01']['container_ip'] }}:{{ hostvars['rvr01']['moonbeam_chain_rpc_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['rvr01']['moonbeam_chain_ws_port'] }}"
        to_host: "{{ hostvars['rvr01']['container_ip'] }}:{{ hostvars['rvr01']['moonbeam_chain_ws_port'] }}"
        protocol: "tcp"
...
