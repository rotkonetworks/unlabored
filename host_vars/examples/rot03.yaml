---
host_name: "rot03.rotko.net"
host_timezone: "Europe/Helsinki"
ansible_host: "69.69.69.69"
role: "proxmox"

default_need_port_forwarding: True

default_storage: "zfs_storage"
default_gw_device: "eno2"

kernel_modules:
  - coretemp
  - zfs

# polygon is currently still manually configured so we dont store these ports
# anywhere, reference is here:
# bor 8545
# bor 8546
# bor 30303
# heimdall: 26657
# heimdall: 26656

lxc_nodes:
  - host: "polygon02"
    proxmox_config:
      vmid: "555"
      hostname: "{{ hostvars['polygon02']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['polygon02']['netif'] }}"
      cores: 16
      memory: 32768
      password: M4RG4RETth4tcherIS110%hot
      disk: "{{ default_storage }}:20"
      mounts: '{"mp0":"{{ default_storage }}:5700,mp={{ hostvars["polygon02"]["polygon_storage_path"] }}"}'
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "polygon node: {{ hostvars['polygon02']['host_name'] }}"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "50001"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:10050"
        protocol: "tcp"
      - from_port: "{{ hostvars['polygon02']['ansible_port'] }}"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "8545"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:8545"
        protocol: "tcp"
      - from_port: "8545"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:8545"
        protocol: "udp"
      - from_port: "8546"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:8546"
        protocol: "tcp"
      - from_port: "8546"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:8546"
        protocol: "udp"
      - from_port: "26657"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:26657"
        protocol: "tcp"
      - from_port: "26657"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:26657"
        protocol: "udp"
      - from_port: "26656"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:26656"
        protocol: "tcp"
      - from_port: "26656"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:26656"
        protocol: "udp"
      - from_port: "30303"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:30303"
        protocol: "tcp"
      - from_port: "30303"
        to_host: "{{ hostvars['polygon02']['container_ip'] }}:30303"
        protocol: "udp"
  - host: "ethereum03"
    proxmox_config:
      vmid: "666"
      hostname: "{{ hostvars['ethereum03']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['ethereum03']['netif'] }}"
      mounts: '{"mp0":"{{ default_storage }}:18000,mp={{ hostvars["ethereum03"]["ethereum_storage_path"] }}"}'
      cores: 8
      memory: 32768
      password: M4RG4RETth4tcherIS110%hot
      disk: "{{ default_storage }}:20"
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "ethereum node: {{ hostvars['ethereum03']['host_name'] }}"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "50002"
        to_host: "{{ hostvars['ethereum03']['container_ip'] }}:10050"
        protocol: "tcp"
      - from_port: "{{ hostvars['ethereum03']['ansible_port'] }}"
        to_host: "{{ hostvars['ethereum03']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "{{ hostvars['ethereum03']['ethereum_ws_port'] }}"
        to_host: "{{ hostvars['ethereum03']['container_ip'] }}:{{ hostvars['ethereum03']['ethereum_ws_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['ethereum03']['ethereum_http_port'] }}"
        to_host: "{{ hostvars['ethereum03']['container_ip'] }}:{{ hostvars['ethereum03']['ethereum_http_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['ethereum03']['ethereum_p2p_port'] }}"
        to_host: "{{ hostvars['ethereum03']['container_ip'] }}:{{ hostvars['ethereum03']['ethereum_p2p_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['ethereum03']['ethereum_p2p_port'] }}"
        to_host: "{{ hostvars['ethereum03']['container_ip'] }}:{{ hostvars['ethereum03']['ethereum_p2p_port'] }}"
        protocol: "udp"
      - from_port: "{{ hostvars['ethereum03']['ethereum_lighthouse_beacon_port'] }}"
        to_host: "{{ hostvars['ethereum03']['container_ip'] }}:{{ hostvars['ethereum03']['ethereum_lighthouse_beacon_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['ethereum03']['ethereum_lighthouse_beacon_port'] }}"
        to_host: "{{ hostvars['ethereum03']['container_ip'] }}:{{ hostvars['ethereum03']['ethereum_lighthouse_beacon_port'] }}"
        protocol: "udp"
  - host: "moon05"
    proxmox_config:
      vmid: "777"
      hostname: "{{ hostvars['moon05']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['moon05']['netif'] }}"
      cores: 16
      memory: 32768
      password: M4RG4RETth4tcherIS110%hot
      disk: "{{ default_storage }}:20"
      mounts: '{"mp0":"{{ default_storage }}:1800,mp={{ hostvars["moon05"]["moonbeam_base"] }}"}'
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "moonbeam node: {{ hostvars['moon05']['host_name'] }} with moonbeam blockchain"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "50003"
        to_host: "{{ hostvars['moon05']['container_ip'] }}:10050"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon05']['ansible_port'] }}"
        to_host: "{{ hostvars['moon05']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon05']['moonbeam_base_port'] }}"
        to_host: "{{ hostvars['moon05']['container_ip'] }}:{{ hostvars['moon05']['moonbeam_base_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon05']['moonbeam_base_rpc_port'] }}"
        to_host: "{{ hostvars['moon05']['container_ip'] }}:{{ hostvars['moon05']['moonbeam_base_rpc_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon05']['moonbeam_base_ws_port'] }}"
        to_host: "{{ hostvars['moon05']['container_ip'] }}:{{ hostvars['moon05']['moonbeam_base_ws_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon05']['moonbeam_chain_port'] }}"
        to_host: "{{ hostvars['moon05']['container_ip'] }}:{{ hostvars['moon05']['moonbeam_chain_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon05']['moonbeam_chain_rpc_port'] }}"
        to_host: "{{ hostvars['moon05']['container_ip'] }}:{{ hostvars['moon05']['moonbeam_chain_rpc_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon05']['moonbeam_chain_ws_port'] }}"
        to_host: "{{ hostvars['moon05']['container_ip'] }}:{{ hostvars['moon05']['moonbeam_chain_ws_port'] }}"
        protocol: "tcp"
  - host: "moon06"
    proxmox_config:
      vmid: "888"
      hostname: "{{ hostvars['moon06']['host_name'] }}"
      ostemplate: 'local:vztmpl/{{ default_container_template }}'
      netif: "{{ hostvars['moon06']['netif'] }}"
      cores: 16
      memory: 32768
      password: M4RG4RETth4tcherIS110%hot
      disk: "{{ default_storage }}:20"
      mounts: '{"mp0":"{{ default_storage }}:2300,mp={{ hostvars["moon06"]["moonbeam_base"] }}"}'
      onboot: True
      unprivileged: True
      validate_certs: False
      description: "moonbeam node: {{ hostvars['moon06']['host_name'] }}"
      state: present
      features:
        - nesting=1
    port_forwards:
      - from_port: "50004"
        to_host: "{{ hostvars['moon06']['container_ip'] }}:10050"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon06']['ansible_port'] }}"
        to_host: "{{ hostvars['moon06']['container_ip'] }}:22"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon06']['moonbeam_base_port'] }}"
        to_host: "{{ hostvars['moon06']['container_ip'] }}:{{ hostvars['moon06']['moonbeam_base_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon06']['moonbeam_base_rpc_port'] }}"
        to_host: "{{ hostvars['moon06']['container_ip'] }}:{{ hostvars['moon06']['moonbeam_base_rpc_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon06']['moonbeam_base_ws_port'] }}"
        to_host: "{{ hostvars['moon06']['container_ip'] }}:{{ hostvars['moon06']['moonbeam_base_ws_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon06']['moonbeam_chain_port'] }}"
        to_host: "{{ hostvars['moon06']['container_ip'] }}:{{ hostvars['moon06']['moonbeam_chain_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon06']['moonbeam_chain_rpc_port'] }}"
        to_host: "{{ hostvars['moon06']['container_ip'] }}:{{ hostvars['moon06']['moonbeam_chain_rpc_port'] }}"
        protocol: "tcp"
      - from_port: "{{ hostvars['moon06']['moonbeam_chain_ws_port'] }}"
        to_host: "{{ hostvars['moon06']['container_ip'] }}:{{ hostvars['moon06']['moonbeam_chain_ws_port'] }}"
        protocol: "tcp"
...
